<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FinGamePro</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/home.css">
    <link rel="stylesheet" href="css/leaderboard.css">
    <link rel="stylesheet" href="css/tasks.css">
    <link rel="stylesheet" href="css/games.css">
    <link rel="stylesheet" href="css/wallet.css">

    <link rel="stylesheet" href="css/pro-core.css">
    <link rel="stylesheet" href="css/pro-profile.css">
    <link rel="stylesheet" href="css/pro-brand.css">
    <link rel="stylesheet" href="css/pro-refer.css">
    <link rel="stylesheet" href="css/pro-contact.css">
    <link rel="stylesheet" href="css/pro-info.css"> 

    <style>
        /* üî• FORCE HIDE FIX */
        .hidden {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }

        /* Hamburger Button */
        .menu-trigger {
            position: relative !important;
            z-index: 9999 !important; /* Super High Priority */
            cursor: pointer !important;
            pointer-events: auto !important; /* Force Click */
        }

        /* Menu Styling */
        #side-menu {
            position: fixed !important;
            top: 0 !important;
            right: 0 !important;
            width: 280px !important;
            height: 100vh !important;
            background: #020617 !important; 
            z-index: 2147483647 !important;
            transform: translateX(100%) !important; 
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            box-shadow: -5px 0 25px rgba(0,0,0,0.9) !important;
            display: block !important;
        }

        /* Open State */
        #side-menu.open {
            transform: translateX(0) !important;
        }

        /* Overlay Styling */
        #menu-overlay {
            position: fixed !important;
            top: 0; 
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8) !important;
            z-index: 2147483640 !important;
            backdrop-filter: blur(4px);
            opacity: 0;
            visibility: hidden; /* Chupa hua */
            transition: opacity 0.3s ease;
            pointer-events: none; /* Click through when hidden */
        }

        /* Overlay Visible State */
        #menu-overlay.visible {
            opacity: 1 !important;
            visibility: visible !important;
            pointer-events: auto !important; /* Block clicks when visible */
        }

        /* --- ADDED FOR HI-TECH LOOK --- */
        .neon-text-gold {
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }
        .glass-panel-tech {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        /* üî• FIX: SweetAlert Z-Index & Dark Theme Override */
        .swal2-container {
            z-index: 2147483650 !important; /* Higher than menu */
        }
        
        /* Professional Dark Theme for Alerts */
        div:where(.swal2-container) div:where(.swal2-popup) {
            background: #0f172a !important; 
            border: 1px solid #334155;
            color: #ffffff !important;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
        }
        div:where(.swal2-container) .swal2-title,
        div:where(.swal2-container) .swal2-html-container {
            color: #ffffff !important;
        }
        div:where(.swal2-icon).swal2-warning {
            border-color: #f59e0b !important;
            color: #f59e0b !important;
        }
    </style>
    </head>

<body>

    <div id="app-container">
        
        <header class="app-header glass-effect">
            <div class="logo-area">
                <i class="fa-solid fa-bolt logo-icon"></i>
                <span class="app-name">FinGamePro</span>
            </div>
            <div class="header-actions" style="display: flex; align-items: center; gap: 20px;">
                <div class="coin-badge" onclick="navigateTo('wallet')">
                    <i class="fa-solid fa-coins coin-glow"></i>
                    <span id="header-coin-balance">0</span>
                </div>
                <div id="hamburger-btn" class="menu-trigger" onclick="toggleProfileMenu()">
                    <i class="fa-solid fa-bars"></i>
                </div>
            </div>
        </header>


        <main id="main-content">
            
            <div id="page-profile" class="internal-page hidden" 
                 style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: #020617; z-index: 5000; overflow-y: auto; padding-top: 80px; padding-bottom: 100px;"> 
                
                <div class="page-header" style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px; padding: 0 20px;">
                    <button class="back-btn" onclick="backToProfileMenu()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <h2 class="neon-text" style="margin: 0;">My Identity</h2>
                </div>

                <div class="glass-card profile-card" style="margin: 0 20px;">
                    <div class="avatar-wrapper">
                        <div class="neon-avatar-container">
                            <img id="profile-img" src="assets/default-avatar.png" alt="Profile" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'">
                        </div>
                        <div class="edit-badge" onclick="document.getElementById('file-upload').click()">
                            <i class="fa-solid fa-camera"></i>
                        </div>
                    </div>
                    
                    <input type="file" id="file-upload" accept="image/*" hidden onchange="handleImageUpload(event)">

                    <div class="profile-info" style="text-align: center;">
                        <h3 id="display-name" style="font-size: 22px; margin: 10px 0;">Loading...</h3>
                        <span class="user-id" style="color: #a0a0a0; font-family: monospace;">
                            ID: <span id="display-id">...</span> 
                            <i class="fa-solid fa-circle-check" style="color: #00dcff; margin-left: 5px;"></i>
                        </span>
                    </div>

                    <button class="btn-glow-border" onclick="openEditModal()">Edit Details</button>
                </div>
            </div>

            <div id="edit-modal" class="modal-overlay hidden" style="z-index: 6000;">
                <div class="modal-glass">
                    <h3>Update Profile</h3>
                    <div class="input-group">
                        <label>Display Name</label>
                        <input type="text" id="edit-name-input" class="premium-input" placeholder="Enter Name">
                    </div>
                    <div class="modal-actions">
                        <button class="btn-cancel" onclick="closeEditModal()">Cancel</button>
                        <button class="btn-save" onclick="saveProfileChanges()">Save Changes</button>
                    </div>
                </div>
            </div>


            <div id="page-refer" class="internal-page hidden" 
                 style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: #020617; z-index: 5000; overflow-y: auto; padding-top: 80px; padding-bottom: 100px;">
                
                <div style="padding: 0 20px;">
                    <div class="page-header flex-center-start">
                        <button class="back-btn" onclick="backToProfileMenu()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; margin-right: 15px;">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <h2 class="neon-text" style="margin:0;">Affiliate Center</h2>
                    </div>

                    <div class="refer-hero-card">
                        <div class="refer-stat">
                            <span class="stat-label">Total Partners</span>
                            <h3 id="total-referrals" class="stat-value neon-blue">0</h3>
                        </div>
                        <div class="vertical-divider"></div>
                        <div class="refer-stat">
                            <span class="stat-label">Earnings (Coins)</span>
                            <h3 id="referral-earnings" class="stat-value neon-gold">0</h3>
                        </div>
                    </div>

                    <div class="copy-code-container">
                        <label>YOUR UNIQUE ACCESS CODE</label>
                        <div class="code-box" onclick="copyReferralCode()">
                            <span id="my-referral-code">LOADING...</span>
                            <i class="fa-regular fa-copy"></i>
                        </div>

                        <div style="height: 15px;"></div>
                        <label>YOUR REFERRAL LINK</label>
                        <div class="code-box link-style" onclick="copyReferralCode()">
                            <span id="my-referral-link">Generating Link...</span>
                            <i class="fa-solid fa-share-nodes"></i>
                        </div>
                        </div>

                    <div class="refer-tabs">
                        <button class="tab-btn active" onclick="switchReferTab('milestones')">Milestones</button>
                        <button class="tab-btn" onclick="switchReferTab('team')">My Team (10%)</button>
                    </div>

                    <div id="tab-milestones" class="tab-content active-tab">
                        <div id="milestone-list" class="scrollable-list">
                            </div>
                    </div>

                    <div id="tab-team" class="tab-content hidden">
                        <div class="team-header">
                            <p style="color:#aaa; font-size:12px;">Earn 10% of your friends' income forever.</p>
                            <button class="btn-claim-all" onclick="claimAllCommissions()" style="margin-top:5px;">Claim All</button>
                        </div>
                        <div id="team-list" class="scrollable-list">
                            </div>
                    </div>
                </div>
            </div>


            <div id="page-brand" class="internal-page hidden" 
                 style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: #020617; z-index: 5000; overflow-y: auto; padding-top: 80px; padding-bottom: 100px;">
                
                <div style="padding: 0 20px;">
                    <div class="page-header">
                        <button class="back-btn" onclick="backToProfileMenu()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; margin-right: 15px;">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <h2 class="neon-text" style="margin:0;">Business Partner</h2>
                    </div>
                    
                    <div class="brand-hero-premium">
                        <h1>üöÄ Promote to High-Engagement Audience</h1>
                        <p>Reach 50k+ active users across App, Bot & Socials.</p>
                        <div class="trust-badges">
                            <span><i class="fa-solid fa-circle-check text-green"></i> Verified</span>
                            <span><i class="fa-solid fa-shield-halved text-blue"></i> Brand-Safe</span>
                            <span><i class="fa-solid fa-chart-line text-gold"></i> High ROI</span>
                        </div>
                    </div>

                    <div class="stats-grid-premium">
                        <div class="stat-box">
                            <h3>50,000+</h3>
                            <span>Active Users</span>
                        </div>
                        <div class="stat-box">
                            <h3>1.2M+</h3>
                            <span>Impressions</span>
                        </div>
                        <div class="stat-box">
                            <h3>15%</h3>
                            <span>Avg CTR</span>
                        </div>
                    </div>

                    <div class="value-prop-card">
                        <h4>Why Advertise?</h4>
                        <ul>
                            <li>üéØ <b>Niche Audience:</b> Students, Crypto & Tech</li>
                            <li>‚ö° <b>Fast Execution:</b> Live in 2 hours</li>
                            <li>üìä <b>Transparent:</b> Real-time clicks data</li>
                        </ul>
                    </div>

                    <hr class="divider-premium">

                    <form id="brand-form" onsubmit="return false;">
                        
                        <label class="form-label-premium">1. Choose Placement üìç</label>
                        <div class="promo-scroll-container">
                            <div class="selection-card" onclick="selectOption('asset', 'In-App Banner', this)">
                                <i class="fa-solid fa-pager text-purple"></i>
                                <span>In-App Banner</span>
                            </div>
                            <div class="selection-card" onclick="selectOption('asset', 'Bot Broadcast', this)">
                                <i class="fa-solid fa-bullhorn text-gold"></i>
                                <span>Bot Broadcast</span>
                            </div>
                            <div class="selection-card" onclick="selectOption('asset', 'Task Integration', this)">
                                <i class="fa-solid fa-list-check text-green"></i>
                                <span>Task List</span>
                            </div>
                            <div class="selection-card" onclick="selectOption('asset', 'Telegram Post', this)">
                                <i class="fa-brands fa-telegram text-blue"></i>
                                <span>Telegram Post</span>
                            </div>
                            <div class="selection-card" onclick="selectOption('asset', 'Instagram', this)">
                                <i class="fa-brands fa-instagram text-pink"></i>
                                <span>Instagram</span>
                            </div>
                        </div>
                        <input type="hidden" id="input-asset">

                        <label class="form-label-premium">2. Ad Format üéØ</label>
                        <div class="chips-container">
                            <div class="chip" onclick="selectOption('format', 'Banner Image', this)">Banner Image</div>
                            <div class="chip" onclick="selectOption('format', 'Video Ad', this)">Video Ad</div>
                            <div class="chip" onclick="selectOption('format', 'Text + Link', this)">Text + Link</div>
                            <div class="chip" onclick="selectOption('format', 'Native Task', this)">Native Task</div>
                        </div>
                        <input type="hidden" id="input-format">

                        <label class="form-label-premium">3. Duration ‚è±</label>
                        <div class="chips-container">
                            <div class="chip" onclick="selectOption('duration', '24 Hours', this)">24 Hours</div>
                            <div class="chip" onclick="selectOption('duration', '3 Days', this)">3 Days</div>
                            <div class="chip" onclick="selectOption('duration', '7 Days', this)">7 Days</div>
                            <div class="chip" onclick="selectOption('duration', 'Lifetime', this)">Lifetime</div>
                        </div>
                        <input type="hidden" id="input-duration">

                        <label class="form-label-premium">4. Budget Range üí∞</label>
                        <div class="chips-container">
                            <div class="chip" onclick="selectOption('budget', '500-1k', this)">‚Çπ500 - 1k</div>
                            <div class="chip" onclick="selectOption('budget', '1k-5k', this)">‚Çπ1k - 5k</div>
                            <div class="chip" onclick="selectOption('budget', '5k-20k', this)">‚Çπ5k - 20k</div>
                            <div class="chip" onclick="selectOption('budget', '50k+', this)">‚Çπ50k+ (Partner)</div>
                        </div>
                        <input type="hidden" id="input-budget">

                        <label class="form-label-premium">5. Business Details üìù</label>
                        <input type="text" id="brand-contact" class="premium-input mb-2" placeholder="Official Email or WhatsApp">
                        <textarea id="brand-message" class="premium-input" rows="4" placeholder="Brief about your app/brand & requirements..."></textarea>

                        <button class="btn-submit-proposal" onclick="sendPremiumProposal()">
                            üöÄ Send Sponsorship Proposal
                        </button>
                        <p class="submit-note">Review time: Within 24 Hours</p>

                    </form>

                    <div class="brand-footer">
                        <p><i class="fa-solid fa-lock"></i> Secure & Confidential</p>
                        <p>¬© 2025 FinGamePro Business</p>
                    </div>
                </div>
            </div>


            <div id="page-contact" class="internal-page hidden" 
                 style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: #020617; z-index: 5000; overflow-y: auto; padding-top: 80px; padding-bottom: 100px;">
                
                <div style="padding: 0 20px;">
                    <div class="page-header">
                        <button class="back-btn" onclick="backToProfileMenu()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; margin-right: 15px;">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <h2 class="neon-text" style="margin:0;">Contact Support</h2>
                    </div>
                    <p style="color:#888; font-size:12px; margin-top:-10px; margin-bottom: 20px;">Hum aapki madad ke liye hamesha available hain.</p>

                    <div class="support-grid">
                        
                        <div class="support-card" onclick="openSupportChat('telegram')">
                            <div class="sc-icon bg-blue"><i class="fa-brands fa-telegram"></i></div>
                            <div class="sc-info">
                                <h4>Live Chat Support</h4>
                                <p>Within 30 minutes</p>
                            </div>
                            <i class="fa-solid fa-chevron-right arrow-icon"></i>
                        </div>

                        <div class="support-card disabled" onclick="openSupportChat('whatsapp')">
                            <div class="coming-soon-badge">Coming Soon</div>
                            <div class="sc-icon bg-green"><i class="fa-brands fa-whatsapp"></i></div>
                            <div class="sc-info">
                                <h4>WhatsApp Support</h4>
                                <p>10 AM ‚Äì 8 PM</p>
                            </div>
                        </div>

                        <div class="support-card ai-card" onclick="openSupportChat('ai')">
                            <div class="sc-icon bg-purple"><i class="fa-solid fa-robot"></i></div>
                            <div class="sc-info">
                                <h4>AI Help Desk ü§ñ</h4>
                                <p>Instant Answers 24/7</p>
                            </div>
                            <button class="btn-ask-ai">Ask AI</button>
                        </div>
                    </div>

                    <hr class="divider-premium">

                    <h3 class="section-heading">üìù Submit a Request</h3>
                    <form id="support-form" onsubmit="return false;">
                        
                        <div class="input-group-premium">
                            <label>Full Name</label>
                            <input type="text" id="sup-name" placeholder="Enter your name" class="premium-input">
                        </div>

                        <div class="row-inputs">
                            <div class="input-group-premium">
                                <label>Email Address</label>
                                <input type="email" id="sup-email" placeholder="name@email.com" class="premium-input">
                            </div>
                            <div class="input-group-premium">
                                <label>Mobile Number</label>
                                <input type="tel" id="sup-mobile" placeholder="+91 XXXXX" class="premium-input">
                            </div>
                        </div>

                        <div class="input-group-premium">
                            <label>Issue Category</label>
                            <div class="custom-select-wrapper">
                                <select id="sup-category" class="premium-input">
                                    <option value="" disabled selected>Select an issue...</option>
                                    <option value="Payment Issue">Payment / Withdrawal Issue</option>
                                    <option value="Account Problem">Account Login / Ban</option>
                                    <option value="Subscription">Premium Subscription</option>
                                    <option value="Bug Report">App Bug / Error</option>
                                    <option value="Other">Other Inquiry</option>
                                </select>
                                <i class="fa-solid fa-chevron-down select-arrow"></i>
                            </div>
                        </div>

                        <div class="input-group-premium">
                            <label>Description</label>
                            <textarea id="sup-message" rows="4" placeholder="Please describe your problem..." class="premium-input"></textarea>
                        </div>

                        <div class="input-group-premium">
                            <label>Upload Screenshot (Optional)</label>
                            <div class="file-upload-box" onclick="document.getElementById('sup-file').click()">
                                <i class="fa-solid fa-cloud-arrow-up"></i>
                                <span id="file-name">Tap to upload image</span>
                                <input type="file" id="sup-file" hidden onchange="updateFileName(this)">
                            </div>
                        </div>

                        <button class="btn-submit-ticket" onclick="submitSupportTicket()">
                            üîò Submit Request
                        </button>
                        <p class="submit-note">Response time: 12-24 Hours</p>

                    </form>

                    <div class="support-footer">
                        <div class="timings-box">
                            <i class="fa-solid fa-clock text-gold"></i>
                            <div>
                                <strong>Support Hours:</strong><br>
                                Mon ‚Äì Sat: 10 AM ‚Äì 8 PM<br>
                                <span style="color:#ff4444; font-size:10px;">Sunday: Emergency Only</span>
                            </div>
                        </div>
                        
                        <div class="trust-lines">
                            <p><i class="fa-solid fa-shield-halved text-green"></i> 100% Secure Data</p>
                            <p><i class="fa-solid fa-headset text-blue"></i> Verified Support Team</p>
                        </div>
                    </div>

                </div>
            </div>


            <div id="page-info" class="internal-page hidden" 
                 style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: #020617; z-index: 5000; overflow-y: auto; padding-top: 80px; padding-bottom: 50px;">
                
                <div style="padding: 0 20px;">
                    <div class="page-header">
                        <button class="back-btn" onclick="backToProfileMenu()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer; margin-right: 15px;">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <h2 id="info-title" class="neon-text" style="margin:0;">Information</h2>
                    </div>

                    <div id="info-content" class="info-body-container">
                        </div>

                    <div class="legal-footer">
                        <p>¬© 2025 FinGamePro Inc. All Rights Reserved.</p>
                    </div>
                </div>
            </div>


            <section id="home" class="page-section active">
                
                <div class="hero-card" data-aos="fade-down">
                    <div class="hero-header">
                        <span class="hero-title">Total Balance</span>
                        <div class="wallet-icon-3d"><i class="fa-solid fa-wallet"></i></div>
                    </div>
                    <div class="hero-balance">
                        <i class="fa-solid fa-coins"></i>
                        <span id="home-balance-display">0</span>
                    </div>
                    <div class="hero-subtext">‚âà ‚Çπ 0.00 INR</div>
                    <button class="withdraw-btn-main" onclick="navigateTo('wallet')">
                        Withdraw Funds <i class="fa-solid fa-arrow-right"></i>
                    </button>
                </div>

                <div class="section-title">Quick Earn</div>
                <div class="action-grid" data-aos="fade-up">
                    <div class="action-card" onclick="navigateTo('tasks')">
                        <div class="icon-box blue"><i class="fa-solid fa-list-check"></i></div>
                        <span>Tasks</span>
                    </div>
                    <div class="action-card" onclick="navigateTo('games')">
                        <div class="icon-box purple"><i class="fa-solid fa-gamepad"></i></div>
                        <span>Games</span>
                    </div>
                    <div class="action-card" onclick="navigateTo('tasks')">
                        <div class="icon-box red"><i class="fa-solid fa-play"></i></div>
                        <span>Ads</span>
                    </div>
                    <div class="action-card" onclick="openInternalPage('page-refer')">
                        <div class="icon-box green"><i class="fa-solid fa-user-plus"></i></div>
                        <span>Refer</span>
                    </div>
                </div>

                <div class="section-title">
                    Smart Tools <span class="badge-viral">Viral</span>
                </div>
                <div class="tools-grid" data-aos="fade-up" data-aos-delay="100">
                    <div class="tool-card" onclick="openToolModal('cv')">
                        <div class="tool-icon bg-blue"><i class="fa-solid fa-file-invoice"></i></div>
                        <div class="tool-info"><h3>CV Builder</h3><p>AI Resume Creator</p></div>
                        <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                    </div>
                    <div class="tool-card" onclick="openToolModal('love')">
                        <div class="tool-icon bg-pink"><i class="fa-solid fa-heart"></i></div>
                        <div class="tool-info"><h3>Love Calc</h3><p>AI Compatibility</p></div>
                        <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                    </div>
                    <div class="tool-card" onclick="openToolModal('marriage')">
                        <div class="tool-icon bg-gold"><i class="fa-solid fa-ring"></i></div>
                        <div class="tool-info"><h3>Wedding Date</h3><p>Prediction AI</p></div>
                        <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                    </div>
                    <div class="tool-card" onclick="openToolModal('career')">
                        <div class="tool-icon bg-purple"><i class="fa-solid fa-rocket"></i></div>
                        <div class="tool-info"><h3>Career 2035</h3><p>Future Role</p></div>
                        <div class="lock-overlay"><i class="fa-solid fa-lock"></i></div>
                    </div>
                </div>

                <div class="offer-slider" data-aos="fade-left">
                    <div class="offer-card gradient-1">
                        <div><h4>Super Offer üöÄ</h4><p>Earn 500 Coins instantly!</p></div>
                        <button class="btn-sm" onclick="navigateTo('tasks')">Go</button>
                    </div>
                </div>

                <div class="motivation-strip">üéâ You can still earn <b>1200 coins</b> today!</div>
            </section>

            <div id="tool-modal" class="modal-overlay hidden">
                <div class="modal-content glass-effect">
                    <div class="modal-header">
                        <h3 id="tool-modal-title">Tool Name</h3>
                        <button class="close-btn" onclick="closeToolModal()"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                    <div class="modal-body" id="tool-modal-body"></div>
                </div>
            </div>


            <section id="leaderboard" class="page-section hidden">
                <div class="arena-header">
                    <div class="live-badge">
                        <div class="live-dot"></div> LIVE ARENA
                    </div>
                    <div class="sync-timer">SYNC IN <span id="sync-countdown">05:00</span></div>
                </div>

                <div class="podium-stage">
                    <div class="podium-player p-rank-2">
                        <div class="p-avatar-box">
                            <img id="podium-p2-img" src="assets/avatars/2.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'">
                            <div class="p-badge">#2</div>
                        </div>
                        <div class="p-name" id="podium-p2-name">Loading...</div>
                        <div class="p-score" id="podium-p2-score">0</div>
                    </div>

                    <div class="podium-player p-rank-1">
                        <div class="p-crown"><i class="fa-solid fa-crown"></i></div>
                        <div class="p-avatar-box main-glitch">
                            <img id="podium-p1-img" src="assets/avatars/1.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'">
                            <div class="p-badge gold">#1</div>
                        </div>
                        <div class="p-name gold-text" id="podium-p1-name">Loading...</div>
                        <div class="p-score gold-text" id="podium-p1-score">0</div>
                    </div>

                    <div class="podium-player p-rank-3">
                        <div class="p-avatar-box">
                            <img id="podium-p3-img" src="assets/avatars/3.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'">
                            <div class="p-badge">#3</div>
                        </div>
                        <div class="p-name" id="podium-p3-name">Loading...</div>
                        <div class="p-score" id="podium-p3-score">0</div>
                    </div>
                </div>

                <div class="rank-list-container" id="rank-list-feed">
                    </div>

                <div class="user-sticky-rank">
                    <div class="usr-left">
                        <img id="sticky-user-img" src="" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'">
                        <div class="my-rank-info">
                            <h4 id="my-rank-val">#--</h4>
                            <p>YOU</p>
                        </div>
                    </div>
                    <div class="usr-right">
                        <div class="gap-indicator" id="gap-val">CALCULATING...</div>
                        <i class="fa-solid fa-caret-up" style="color:#00f260"></i>
                    </div>
                </div>
            </section>


            <section id="tasks" class="page-section hidden">
                <div class="section-header">
                    <h2>Mission Control</h2>
                    <p>COMPLETE TASKS TO MINE ASSETS</p>
                </div>
                
                <div class="watch-earn-hero">
                    <div class="we-card-inner">
                        <div class="play-icon-box">
                            <i class="fa-brands fa-youtube"></i>
                        </div>
                        <div class="we-content">
                            <h4>Watch Premium Stream</h4>
                            <p>30 SECONDS ‚Ä¢ HIGH PRIORITY</p>
                            <div class="progress-bar-container hidden" id="ad-progress-container">
                                <div class="progress-bar" id="ad-progress-bar"></div>
                            </div>
                        </div>
                        <div class="reward-pill" onclick="startWatchTask(this)">
                            +500 <i class="fa-solid fa-coins"></i>
                        </div>
                    </div>
                </div>

                <div class="native-ad-card" onclick="window.open('https://google.com', '_blank')">
                    <div class="ad-badge">RECOMMENDED</div>
                    <div class="ad-icon-box">
                        <i class="fa-solid fa-gift"></i>
                    </div>
                    <div class="ad-content">
                        <h4>Daily Bonus Mission</h4>
                        <p>Register to unlock VIP status</p>
                    </div>
                    <div class="ad-action-btn">OPEN</div>
                </div>

                <div class="task-divider">AVAILABLE CHANNELS</div>

                <div class="tasks-list" id="telegram-tasks-list">
                    <div class="loading-spinner">
                        <i class="fa-solid fa-radar fa-spin"></i> LOCATING SIGNALS...
                    </div>
                </div>

                <div class="task-divider">SYSTEM OPERATIONS</div>

                <div class="tasks-list">
                    <div class="task-card">
                        <div class="task-icon">
                            <i class="fa-solid fa-users" style="color:#22c55e"></i>
                        </div>
                        <div class="task-info">
                            <h4>Invite New Agent</h4>
                            <div class="reward-badge">+1000 Coins</div>
                        </div>
                        <button class="btn-join" onclick="openInternalPage('page-refer')">START</button>
                    </div>

                    <div class="task-card">
                        <div class="task-icon">
                            <i class="fa-solid fa-file-invoice" style="color:#a855f7"></i>
                        </div>
                        <div class="task-info">
                            <h4>Generate AI CV</h4>
                            <div class="reward-badge">+500 Coins</div>
                        </div>
                        <button class="btn-join" onclick="navigateTo('home')">OPEN</button>
                    </div>
                </div>

                <div style="height: 40px;"></div> </section>

            <section id="games" class="page-section hidden">
                
                <div id="game-native-ad" class="native-ad-placeholder" onclick="window.open('https://www.binance.com', '_blank')">
                    <span><i class="fa-solid fa-ad"></i> SPONSORED SYSTEM</span>
                </div>

                <div class="game-header">
                    <div class="user-rank-badge">
                        <span class="rank-icon">üèÜ</span>
                        <span id="rank-name">Bronze Operator</span>
                    </div>
                    
                    <div class="mining-hud">
                        <div class="current-mining-label">MINING PROTOCOL</div>
                        <div id="display-balance" class="big-gold-text">0</div>
                    </div>
                </div>
                
                <div class="tap-arena">
                    <div id="click-effects-layer"></div>
                    
                    <div class="cyber-ring"></div> 

                    <div id="coin-ban-timer" class="ban-timer-overlay hidden">05:00</div>
                    
                    <div class="coin-container">
                        <img src="assets/coin_main.jpg.png" alt="Tap Coin" id="tap-coin" class="main-coin" draggable="false" oncontextmenu="return false;">
                    </div>

                    <div class="game-floating-actions">
                        <div class="hitech-icon-btn booster" id="btn-booster-action">
                            <i class="fa-solid fa-rocket"></i>
                            <span id="btn-booster-badge" class="icon-badge">--/9</span>
                        </div>
                        <div class="hitech-icon-btn refill" id="btn-refill-action">
                            <i class="fa-solid fa-bolt-lightning"></i>
                            <span id="btn-refill-badge" class="icon-badge">--/9</span>
                        </div>
                    </div>
                </div>

                <div class="energy-control-panel">
                    <div class="energy-info">
                        <span><i class="fa-solid fa-bolt text-cyan"></i> SYSTEM POWER</span>
                        <span id="energy-text">1000 / 1000</span>
                    </div>
                    <div class="energy-bar-bg">
                        <div id="energy-fill" class="energy-fill" style="width: 100%;"></div>
                    </div>
                    
                    <div class="security-badge">
                        <span id="security-status"><i class="fa-solid fa-shield-halved"></i> SECURED</span>
                        <span class="text-green"><i class="fa-solid fa-check-circle"></i> ANTI-CHEAT ACTIVE</span>
                    </div>
                </div>

                <div id="ban-overlay" class="hidden" style="display:none;"> </div>
            </section>
            <div id="game-modal" class="game-modal hidden">
                <div class="gm-header">
                    <div class="gm-timer"><i class="fa-solid fa-clock"></i> Play for <span id="game-timer">15</span>s to earn</div>
                    <button class="gm-close" onclick="closeGame()"><i class="fa-solid fa-xmark"></i> Exit</button>
                </div>
                <div class="gm-iframe-container"><iframe id="game-frame" src="" frameborder="0"></iframe></div>
            </div>


            <section id="wallet" class="page-section hidden">
                
                <div id="boot-sequence" class="hidden">
                    <i class="fa-solid fa-microchip" style="font-size: 40px; color: var(--aegis-cyan); margin-bottom: 20px; animation: plasmaPulse 2s infinite;"></i>
                    <div id="boot-terminal">
                        <div id="boot-terminal-text"></div>
                    </div>
                    <div id="boot-loader-bar">
                        <div id="boot-loader-fill"></div>
                    </div>
                </div>

                <div class="aegis-core-container">
                    <div class="gyro-ring ring-outer"></div>
                    <div class="gyro-ring ring-mid"></div>
                    <div class="gyro-ring ring-inner"></div>
                    
                    <div class="plasma-orb">
                        <span class="power-label">POWER LEVEL</span>
                        <span class="power-val-glitch" id="core-power-val">--</span>
                        <span class="power-unit">UNITS</span>
                    </div>
                </div>

                <div class="hud-stats-container">
                    <div class="hud-panel">
                        <div class="hud-label">ACCESS CLEARANCE</div>
                        <div class="hud-val" id="clearance-val">CALCULATING...</div>
                    </div>
                    <div class="hud-panel" style="text-align: right;">
                        <div class="hud-label">SYSTEM STATUS</div>
                        <div class="hud-val" id="system-status-val">STANDING BY</div>
                    </div>
                </div>

                <div class="protocol-feed-header">
                    <i class="fa-solid fa-list-check"></i> AVAILABLE PROTOCOLS
                </div>
                <div id="protocol-feed-container" class="protocol-container">
                    </div>

                <div class="vault-gate-container" onclick="handleVaultAccess()">
                    <div class="gate-door gate-left"></div>
                    <div class="gate-door gate-right"></div>
                    <div class="gate-content">
                        <i class="fa-solid fa-lock gate-lock-icon"></i>
                        <div class="gate-title">VAULT SEALED</div>
                        <div class="gate-subtitle">AWAITING PHASE 2 UNLOCK PROTOCOL</div>
                    </div>
                </div>

            </section>

        </main> 
        <nav class="bottom-nav glass-effect">
            <div class="nav-item active" onclick="navigateTo('home')">
                <i class="fa-solid fa-house"></i><span>Home</span>
            </div>
            <div class="nav-item" onclick="navigateTo('leaderboard')">
                <i class="fa-solid fa-trophy"></i><span>Rank</span>
            </div>
            <div class="nav-item" onclick="navigateTo('tasks')">
                <i class="fa-solid fa-list-check"></i><span>Tasks</span>
            </div>
            <div class="nav-item" onclick="navigateTo('games')">
                <i class="fa-solid fa-gamepad"></i><span>Games</span>
            </div>
            <div class="nav-item" onclick="navigateTo('wallet')">
                <i class="fa-solid fa-wallet"></i><span>Wallet</span>
            </div>
        </nav>

    </div>  
    <div id="menu-overlay" class="menu-overlay hidden" style="z-index: 2147483640;" onclick="toggleProfileMenu()"></div>

    <div id="side-menu" class="side-menu" style="z-index: 2147483647;">
        <div class="menu-header">
            <span class="text-gold">Menu</span>
            <i class="fa-solid fa-xmark close-menu" onclick="toggleProfileMenu()"></i>
        </div>
        
        <div class="menu-list">
            <div class="menu-item" onclick="openInternalPage('page-profile')"><div class="mi-icon"><i class="fa-solid fa-user"></i></div><span>My Profile</span></div>
            <div class="menu-item" onclick="handleMenuNav('wallet')"><div class="mi-icon"><i class="fa-solid fa-wallet"></i></div><span>Wallet & Earnings</span></div>
            <div class="menu-item" style="opacity: 0.6;"><div class="mi-icon"><i class="fa-solid fa-id-card"></i></div><span>KYC Verification</span><span style="font-size: 10px; background: #334155; padding: 2px 6px; border-radius: 4px; margin-left: auto;">Coming Soon</span></div>
            <div class="menu-item" onclick="openInternalPage('page-refer')"><div class="mi-icon"><i class="fa-solid fa-gift"></i></div><span>Refer & Earn</span></div>
            <div class="menu-item highlight-box" onclick="openInternalPage('page-brand')"><div class="mi-icon"><i class="fa-solid fa-handshake text-gold"></i></div><span class="text-gold" style="font-weight: 700;">Brand / Sponsorship ‚≠ê</span></div>
            
            <hr class="menu-divider">
            
            <div class="menu-item small" onclick="openInfoPage('withdraw_terms')"><div class="mi-icon"><i class="fa-solid fa-file-invoice-dollar"></i></div><span>Withdrawal Terms</span></div>
            <div class="menu-item small" onclick="openInfoPage('terms')"><div class="mi-icon"><i class="fa-solid fa-file-contract"></i></div><span>Terms & Conditions</span></div>
            <div class="menu-item small" onclick="openInfoPage('privacy')"><div class="mi-icon"><i class="fa-solid fa-lock"></i></div><span>Privacy Policy</span></div>
            <div class="menu-item small" onclick="openInfoPage('disclaimer')"><div class="mi-icon"><i class="fa-solid fa-triangle-exclamation"></i></div><span>Disclaimer</span></div>
            
            <hr class="menu-divider">
            
            <div class="menu-item small" onclick="openInfoPage('faq')"><div class="mi-icon"><i class="fa-solid fa-circle-question"></i></div><span>Help / FAQ</span></div>
            <div class="menu-item small" onclick="openInternalPage('page-contact')"><div class="mi-icon"><i class="fa-solid fa-headset"></i></div><span>Contact Support</span></div>
            <div class="menu-item logout" onclick="handleLogout()"><div class="mi-icon"><i class="fa-solid fa-right-from-bracket"></i></div><span>Logout</span></div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script type="module" src="js/main.js"></script> 
    <script type="module" src="js/firebase-init.js"></script>
    
    <script src="js/pro-core.js"></script>

    <script src="js/home.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/games.js"></script>
    <script src="js/leaderboard.js"></script>

    <script src="js/pro-profile.js"></script>
    <script src="js/pro-refer.js"></script>
    <script src="js/pro-brand.js"></script>
    <script src="js/pro-contact.js"></script>
    <script src="js/pro-info.js"></script>

    <script>
      AOS.init();
      
      // Initialize active section tracking
      let currentActiveSectionId = 'home';
      
      // Add listeners to navigation items to track current section
      document.querySelectorAll('.nav-item').forEach(item => {
          item.addEventListener('click', function() {
             const onclickVal = this.getAttribute('onclick');
             // extracting 'home' from "navigateTo('home')"
             if(onclickVal) {
                 const match = onclickVal.match(/'([^']+)'/);
                 if(match && match[1]) {
                     currentActiveSectionId = match[1];
                 }
             }
          });
      });

      // Menu Navigation Handler (Wallet Fix)
      window.handleMenuNav = function(section) {
          if(typeof navigateTo === 'function') {
              navigateTo(section);
              currentActiveSectionId = section; // update tracker
          }
          toggleProfileMenu(false); // Close menu
      }

      // Logout Handler (Close App)
      window.handleLogout = function() {
          Swal.fire({
            title: 'Logout?',
            text: "Close the app and return to Telegram?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Yes, Close'
          }).then((result) => {
            if (result.isConfirmed) {
                if(window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.close();
                } else {
                    window.location.reload(); // Fallback
                }
            }
          });
      }

      // Reliable Menu Toggle
      window.toggleProfileMenu = function(forceState) {
          const menu = document.getElementById('side-menu');
          const overlay = document.getElementById('menu-overlay');
          
          if (!menu || !overlay) {
              console.error("Menu elements not found!");
              return;
          }

          // Close
          if (forceState === false) {
              menu.classList.remove('open');
              overlay.classList.remove('visible');
              return;
          }
          // Open
          if (forceState === true) {
              menu.classList.add('open');
              overlay.classList.add('visible');
              return;
          }
          
          // Toggle
          if (menu.classList.contains('open')) {
              menu.classList.remove('open');
              overlay.classList.remove('visible');
          } else {
              menu.classList.add('open');
              overlay.classList.add('visible');
          }
      };

      // ‚úÖ FIXED: Back Button Logic (State Persistence)
      window.backToProfileMenu = function() {
          // 1. Pehle Menu Kholo
          window.toggleProfileMenu(true);

          // 2. Jo Page khula tha usko chhupa do (Hide Internal Page)
          document.querySelectorAll('.internal-page').forEach(p => p.classList.add('hidden'));

          // 3. Ensure the current main section is visible (Don't force Home)
          // Check if all page-sections are hidden. If so, reveal the last active one.
          const sections = document.querySelectorAll('.page-section');
          let anyVisible = false;
          sections.forEach(s => {
              if(!s.classList.contains('hidden') && s.style.display !== 'none') {
                  anyVisible = true;
              }
          });
          
          if(!anyVisible) {
              // If nothing is visible (because internal page covered it), show last active
              const target = document.getElementById(currentActiveSectionId);
              if(target) target.classList.remove('hidden');
              else {
                   // Fallback to home if something goes wrong
                   const home = document.getElementById('home');
                   if(home) home.classList.remove('hidden');
              }
          }
      };

      // üî• FIX: Brand Proposal Function (BACKEND CONNECT - Full Data)
      window.sendPremiumProposal = function() {
          const brandName = document.getElementById('brand-contact').value || "Not Provided";
          const message = document.getElementById('brand-message').value || "No Details";

          // Capture Hidden Fields (Chip Selection)
          const asset = document.getElementById('input-asset').value || "Not Selected";
          const format = document.getElementById('input-format').value || "Not Selected";
          const duration = document.getElementById('input-duration').value || "Not Selected";
          const budget = document.getElementById('input-budget').value || "Not Selected";
          
          if(!brandName || brandName.length < 3) {
             Swal.fire({
                 icon: 'error',
                 title: 'Details Required',
                 text: 'Please provide valid contact info.',
                 background: '#1e293b', color: '#fff'
             });
             return;
          }

          Swal.fire({
              icon: 'success',
              title: 'Proposal Sent!',
              text: 'Opening Telegram to finalize details...',
              timer: 2000,
              showConfirmButton: false,
              background: '#1e293b', color: '#fff'
          }).then(() => {
              // Construct Full Report for Admin
              const text = `üöÄ *New Sponsorship Proposal*\n\n` +
                           `üìç Placement: ${asset}\n` +
                           `üéØ Format: ${format}\n` +
                           `‚è± Duration: ${duration}\n` +
                           `üí∞ Budget: ${budget}\n` +
                           `---------------------------\n` +
                           `üë§ Contact: ${brandName}\n` +
                           `üìù Details: ${message}`;
                           
              const encoded = encodeURIComponent(text);
              // üëá REPLACE 'FinGamePro_Support' WITH YOUR USERNAME
              window.open(`https://t.me/FinGamePro_Support?text=${encoded}`, '_blank');
          });
      }

      // üî• FIX: Support Ticket Function (BACKEND CONNECT - Full Data)
      window.submitSupportTicket = function() {
          const name = document.getElementById('sup-name').value || "Unknown";
          const email = document.getElementById('sup-email').value || "N/A";
          const mobile = document.getElementById('sup-mobile').value || "N/A";
          const category = document.getElementById('sup-category').value;
          const msg = document.getElementById('sup-message').value;

          if(!category || !msg) {
              Swal.fire({
                 icon: 'warning',
                 title: 'Missing Info',
                 text: 'Please select a category and describe the issue.',
                 background: '#1e293b', color: '#fff'
             });
             return;
          }

          Swal.fire({
              icon: 'success',
              title: 'Ticket Submitted',
              text: 'Support team will contact you via Telegram.',
              background: '#1e293b', color: '#fff'
          }).then(() => {
              // Construct Full Ticket Report
              const text = `üõ† *Support Ticket*\n\n` +
                           `üë§ Name: ${name}\n` +
                           `üìß Email: ${email}\n` +
                           `üì± Mobile: ${mobile}\n` +
                           `---------------------------\n` +
                           `üìÇ Issue: ${category}\n` +
                           `üí¨ Desc: ${msg}`;

              const encoded = encodeURIComponent(text);
              // üëá REPLACE 'FinGamePro_Support' WITH YOUR USERNAME
              window.open(`https://t.me/FinGamePro_Support?text=${encoded}`, '_blank');
          });
      }

    </script>
</body>
</html>
